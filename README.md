# Tetris-AI

Tetris-AI is a project that allows you to control a Tetris game using hand positions captured from a camera. The goal is to manipulate the game pieces by detecting the position of your wrists in real-time. This project has been tested on the Nvidia Jetson Xavier NX 16 GB, running Jetpack 5.1.1 rev 1.

## Table of Contents

- [Story](#story)
- [Hardware requirements](#hardware-requirements)
- [Pre-requisites](#pre-requisites)
- [Install Tetris-AI](#install-tetris-ai)
  - [x64-based dependencies installation](#x64-based-dependencies-installation)
  - [Jetson-based dependencies installation](#jetson-based-dependencies-installation)
- [Rules](#rules)
- [Run the game](#run-the-game)
- [Demo](#demo)
- [Credits](#credits)


<a id="story"></a>
## Story

In 2023, [Arhs Spikeseed](https://www.spikeseed.cloud/), the company I am working for, had the exciting opportunity to participate in Voxxed Days Luxembourg, a renowned technology conference. We set up a stand at the event, aiming to engage with attendees and showcase our innovative projects.

At our stand, we wanted to offer a unique and interactive experience for visitors, giving them the chance to win prizes while having fun. To accomplish this, we developed the Tetris AI game, a captivating adaptation of the classic Tetris game that incorporated artificial intelligence and hand gesture control.

We were thrilled to see the enthusiastic response from the conference attendees. People of all skill levels, from beginners to seasoned gamers, lined up to try their hand at the Tetris AI challenge. In total, we recorded an impressive 150 plays by different individuals throughout the event.

<a id="hardware-requirements"></a>
## Hardware requirements

To run the Tetris-AI application, the following hardware components are necessary:

- **Nvidia Jetson Xavier**: The application has been specifically tested and optimized for the Nvidia Jetson Xavier platform. The Jetson Xavier provides powerful GPU acceleration and is well-suited for AI and computer vision applications.
- **USB Camera**: A USB camera is required to capture real-time images for hand gesture detection. Ensure that the camera is compatible with the Nvidia Jetson Xavier and capable of providing a clear and stable video feed.
- **Monitor with 1920x1080 Resolution**: The Tetris-AI game has been designed to have a resolution of 1920x1080 pixels. To fully enjoy the game's visuals and ensure a seamless gameplay experience, it is recommended to use a monitor with this resolution. This will provide a clear and crisp display, showcasing the game's graphics and allowing for smooth gameplay

By ensuring that you have the above hardware components, you can set up an environment that supports the Tetris-AI application, enabling you to control the game using hand gestures captured from a USB camera connected to the Nvidia Jetson Xavier.

<a id="pre-requisites"></a>
## Pre-requisites
The Tetris-AI application has been developed and tested using **Nvidia Jetpack 5.1.1 rev 1**, which includes **Python 3.8** and other preinstalled libraries on the Nvidia Jetson Xavier platform. While the application is expected to work with these components, it has not been extensively tested with other versions or configurations.

If you choose to experiment with alternative configurations, please note that it might require additional steps or troubleshooting to ensure proper functionality.

<a id="install-tetris-ai"></a>
## Install Tetris-AI

First, clone the repository : 
```bash
   git clone https://github.com/lweicker/tetris-ai.git
   cd tetris-ai
```
Then, download `resnet18_baseline_att_224x224_A` model available at https://drive.google.com/open?id=1XYDdCUdiF2xxx4rznmLb62SdOUZuoNbd and save it at the root of this repository. This model has been generated by Nvidia and originates from the following repository: [https://github.com/NVIDIA-AI-IOT/trt_pose](https://github.com/NVIDIA-AI-IOT/trt_pose)

Finally, you need to install the Tetris-AI dependencies. Here follows the dependencies installation procedures, for x64 architecture and Jetson, respectively. 

<a id="x64-based-dependencies-installation"></a>
### x64-based dependencies installation

In the command line:
```bash
pip3 install -r requirements-cpu.txt
```

Then, install trt_pose:
```bash
git clone https://github.com/NVIDIA-AI-IOT/trt_pose
cd trt_pose
python3 setup.py install
cd ..
```

<a id="jetson-based-dependencies-installation"></a>
### Jetson-based dependencies installation

Execute the following commands, sequentially:
1. Install _torch_ 2.0.0 and _torchvision_ 0.15.1:
   ```commandline
   sudo apt-get -y install autoconf bc build-essential g++-8 gcc-8 clang-8 lld-8 gettext-base gfortran-8 iputils-ping zlib1g-dev libbz2-dev libc++-dev libpython3-dev libcgal-dev libffi-dev libfreetype6-dev libhdf5-dev libjpeg-dev liblzma-dev libncurses5-dev libncursesw5-dev libpng-dev libreadline-dev libssl-dev libsqlite3-dev libxml2-dev libxslt-dev locales moreutils openssl python-openssl rsync scons python3-pip libopenblas-dev libavcodec-dev libavformat-dev libswscale-dev
   export TORCH_INSTALL=https://developer.download.nvidia.cn/compute/redist/jp/v511/pytorch/torch-2.0.0+nv23.05-cp38-cp38-linux_aarch64.whl
   python3 -m pip install --upgrade pip; python3 -m pip install packaging aiohttp numpy=='1.19.4' scipy=='1.5.3' export "LD_LIBRARY_PATH=/usr/lib/llvm-8/lib:$LD_LIBRARY_PATH"; python3 -m pip install --upgrade protobuf; python3 -m pip install --no-cache $TORCH_INSTALL
   git clone --branch v0.15.1 https://github.com/pytorch/vision torchvision
   cd torchvision
   python3 setup.py install --user
   cd ..
   ```
2. Install _torch2trt_ 0.4.0:
   ```commandline
   git clone --branch v0.4.0 https://github.com/NVIDIA-AI-IOT/torch2trt
   cd torch2trt
   python3 setup.py install --user
   cd ..
   ```
3. Install _trt_pose_:
   ```commandline
   git clone https://github.com/NVIDIA-AI-IOT/trt_pose
   cd trt_pose
   python3 setup.py install --user
   cd ..
   pip3 install numba==0.57.1 pygame==2.5.0 numpy==1.21
   ```

<a id="rules"></a>
## Rules
To participate in the Tetris-AI game, please follow the following rules:

1. **Game Duration**: Each game session has a maximum duration of 3 minutes. The objective is to score as many points as possible within this time limit.
2. **Line Completion Points**: By completing a full line with the falling Tetriminos (game pieces), players can earn points based on the number of lines cleared simultaneously:
   - Completing one line: Players earn 100 points.
   - Completing two lines at once: Players earn 300 points.
   - Completing three lines at once: Players earn 700 points.
   - Completing four lines at once (known as a Tetris): Players earn 1500 points.
3. **Strategy and Gameplay**: Players should aim to strategically place Tetriminos to create and clear as many lines as possible. The game becomes progressively faster, requiring quick thinking and efficient maneuvering to keep up with the increasing speed. Use the hand gesture controls to move, rotate, and accelerate the descent of the Tetriminos to optimize your gameplay strategy.
4. **Leaderboard**: The Tetris-AI application features a daily leaderboard to showcase the top scores achieved by players. Each day, the leaderboard is reset, providing a fresh opportunity for players to compete for the highest score. Test your skills and aim to secure a place at the top of the daily leaderboard!

<a id="run-the-game"></a>
## Run the game
Before running the Tetris-AI game, please follow these steps:

1. If running with a GPU, the first time you launch the game, the pose estimator needs to be converted to TensorRT format. This conversion process may take some time. To initiate the conversion, execute the following command in your terminal:
    ```bash
    python3 main.py
    ```
    Wait until the conversion is complete before proceeding to the next step.

2. Once the conversion is done, you can run the Tetris-AI application by executing the following command:
    ```bash
    python3 main.py
    ```
    This command will start the game and enable the hand gesture controls using the USB camera connected to your Nvidia Jetson Xavier.

    *Note*: Ensure that the necessary dependencies and libraries are installed, as specified in the "Install Tetris-AI" section of this README.
3. **Play the Game**: Use your hands to control the Tetris game pieces. The camera will capture your wrist position, and the AI system will interpret them to move, rotate, and accelerate the Tetriminos. Score as many points as you can within the 3-minute time limit.

Enjoy the immersive experience of playing Tetris-AI!

<a id="demo"></a>
## Demo
Youtube video for the demo:


[![Demo Tetris-AI](https://img.youtube.com/vi/soaf6vT7C64/0.jpg)](https://www.youtube.com/watch?v=soaf6vT7C64)

<a id="credits"></a>
## Credits
The Tetris-AI project acknowledges the following repositories for their contributions:

- **[Python-Tetris](https://github.com/StanislavPetrovV/Python-Tetris)**: The Tetris logic and game mechanics of the Tetris-AI application are based on the code from this repository.
- **[trt_pose](https://github.com/NVIDIA-AI-IOT/trt_pose)**: The pose estimator used in the Tetris-AI application is built upon the trt_pose repository.
- **[torch2trt](https://github.com/NVIDIA-AI-IOT/torch2trt)**: The conversion of the model to TensorRT format, which enhances the performance of the AI system, was made possible by the torch2trt repository.

We express our gratitude to the respective authors and maintainers of these repositories for sharing their work with the community. Their contributions have played a significant role in the development and success of the Tetris-AI project.

Please note that while we have utilized these repositories as a foundation for our project, modifications and customizations specific to Tetris-AI have been made to tailor it to our requirements and integrate the AI controls.

We encourage interested developers to explore these repositories to gain further insights into the underlying technologies and contribute to their continued growth and improvement.